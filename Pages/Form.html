<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Image Gallery</title>

  <!-- jQuery -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

  <!-- Font Awesome for icons -->

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"/>

  <!-- Very Simple Image Viewer -->
  <link rel="stylesheet" href="https://meshesha.github.io/verySimpleImageViewer/css/ImageViewer.css" />
  <script src="https://meshesha.github.io/verySimpleImageViewer/js/jquery.verySimpleImageViewer.js"></script>
  <link rel="stylesheet" href="../Style/CommentBoxPopup.css">
  <link rel="stylesheet" href="../Style/Header.css">
  <link rel="stylesheet" href="../Style/Main.css">

  <style>
   

    .content-area {
      display: flex;
      flex: 1;
      gap: 12px;
      overflow: hidden;
    }

    .left-panel, .right-panel {
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 3px 12px rgba(0, 0, 0, 0.295);
      padding: 20px;
      transition: box-shadow 0.25s ease, transform 0.25s ease;
      overflow: auto;
     
    }

    .left-panel:hover, .right-panel:hover {
      box-shadow: 0 5px 18px rgba(0, 0, 0, 0.12);
      transform: translateY(-2px);
    }

    .left-panel { flex: 0 0 40%; min-width: 500px; display: flex; flex-direction: column; }
    .right-panel { flex: 1;display: flex; flex-direction: column; }

     #left2 {
        flex: 0 0 40%; 
        min-width: 500px;
    }

    .divider {
      width: 8px;
      background: #e3e7f0;
      border-radius: 8px;
      cursor: col-resize;
      flex-shrink: 0;
      transition: all 0.25s ease;
      box-shadow: inset 0 0 3px rgba(0,0,0,0.1);
    }

    .divider:hover {
      background: #c7d2ff;
      box-shadow: 0 0 10px rgba(0,0,255,0.15);
    }

    .divider.active {
      background: linear-gradient(180deg, #0041ff, #00b2ff);
      box-shadow: 0 0 12px rgba(0,0,255,0.4);
    }

    #your_div_image_container {
      width: 100%;
      height: 100%;
      background: #fafbff;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: inset 0 0 10px rgba(0,0,0,0.04);
      position: relative;
    }

    /* Thumbnail Pagination */
    .thumbnail-gallery-wrapper {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      margin-top: 14px;
      position: relative;
    }

    .thumbnail-gallery {
      display: flex;
      gap: 10px;
      overflow: hidden;
      width: 100%;
      justify-content: center;
    }

    .thumbnail-gallery img {
      width: 80px;
      height: 80px;
      border-radius: 8px;
      object-fit: cover;
      cursor: pointer;
      transition: all 0.25s ease;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }

    .thumbnail-gallery img:hover {
      transform: scale(1.08);
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    }

    .thumbnail-gallery img.active {
      border: 3px solid #0041ff;
    }

    .thumb-nav {
      background: #fff;
      border: 1px solid #ccc;
      border-radius: 8px;
      cursor: pointer;
      width: 36px;
      height: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      transition: all 0.2s ease;
    }

    .thumb-nav:hover {
      background: #0041ff;
      color: white;
    }

    .thumb-nav:disabled {
      opacity: 0.3;
      cursor: not-allowed;
    }

    .detached-toolbar {
      position: fixed !important;
      top: 80px;
      left: 20px;
      z-index: 999999999 !important;
      display: flex !important;
      gap: 8px;
    }

    .detached-toolbar img {
      width: 30px;
      height: 30px;
      background: white;
      border-radius: 6px;
      padding: 3px;
      box-shadow: 0 0 6px rgba(0, 0, 0, 0.3);
      cursor: pointer;
    }

    .vsiv-nav-btn {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      font-size: 40px;
      color: rgba(255,255,255,0.8);
      background: rgba(0,0,0,0.2);
      width: 50px;
      height: 70px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 8px;
      cursor: pointer;
      z-index: 9999;
      transition: all 0.2s ease;
    }

    .vsiv-nav-btn:hover {
      background: rgba(0,0,0,0.4);
      color: white;
    }

    .vsiv-prev { left: 10px; }
    .vsiv-next { right: 10px; }

    .reference-lines {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 999;
      background-image:
        linear-gradient(rgba(0,0,0,0.05) 1px, transparent 1px),
        linear-gradient(90deg, rgba(0,0,0,0.05) 1px, transparent 1px);
      background-size: 50px 50px;
    }

    @media (max-width: 992px) {
      .content-area { flex-direction: column; }
      .divider { width: 100%; height: 8px; cursor: row-resize; }
      .left-panel { flex: none; height: 45%; }
      .right-panel { flex: 1; }
      #your_div_image_container { height: 60%; }
    }

     /* Toolbar */
    .toolbar { display:flex; align-items:center; gap:10px; margin-bottom:20px; flex-wrap:wrap; }
    .toolbar button { background:#f8f9fa; border:1px solid #ccc; padding:6px 12px; border-radius:6px; cursor:pointer; font-size:14px; }
    .toolbar button:hover { background:var(--primary); color:#fff; }
    .toolbar .record { margin-left:auto; font-size:14px; font-weight:600; color:var(--primary); }

    /* Form */
    .form-ui { display:flex; flex-direction:column; gap:18px; }
    .form-row { display:flex; flex-direction:column; gap:6px; }
    .form-row.two-cols { display:grid; grid-template-columns:1fr 1fr; gap:20px; }
    .form-row label { font-size:14px; font-weight:600; color:#333; }
    .form-row input,.form-row select,.form-row textarea { padding:10px; border:1px solid #ccc; border-radius:6px; font-size:14px; outline:none; width:100%; box-sizing:border-box; }
    .form-row textarea { resize:vertical; min-height:80px; }
    .form-row input:focus,.form-row select:focus,.form-row textarea:focus { border-color:var(--primary); box-shadow:0 0 0 2px rgba(16,16,97,0.15); }
    .form-row button { padding:10px 20px; background-color:#101061; color:#fff; font-size:15px; font-weight:bold; border:none; border-radius:6px; cursor:pointer; transition:background 0.2s ease-in-out; }
    .form-row button:hover { background-color:#2323a1; }

    /* Image nav */
    .nav-arrow { position:absolute; top:50%; transform:translateY(-50%); background:rgba(101,101,102,0.7); color:#fff; border:none; width:45px; height:45px; font-size:22px; cursor:pointer; border-radius:50%; z-index:10; display:flex; align-items:center; justify-content:center; }
    .nav-arrow.left { left:15px; }
    .nav-arrow.right { right:15px; }
    .nav-arrow:hover { background:rgba(16,16,97,0.9); }
    .thumb { width:80px; height:80px; object-fit:cover; border-radius:6px; cursor:pointer; transition:transform 0.2s, box-shadow 0.2s; }
    .thumb:hover { transform:scale(1.05); box-shadow:0 4px 10px rgba(0,0,0,0.2); }

    /* ✅ Comment system */
    .comment-icon { position:relative; background:#f8f9fa; border:1px solid #ccc; padding:6px 12px; border-radius:6px; cursor:pointer; font-size:14px; display:flex; align-items:center; gap:6px; }
    .comment-count { background:red; color:white; font-size:12px; font-weight:bold; border-radius:50%; padding:2px 6px; position:absolute; top:-5px; right:-5px; }
    .comment-dropdown { position:absolute; top:15%; left:20%;margin-top: 6px; background:#fff; border:1px solid #ccc; border-radius:6px; padding:10px; width:220px; box-shadow:0 4px 12px rgba(0,0,0,0.1); display:none; z-index:1000; }
    .comment-dropdown.active { display:block; }
    .comment-dropdown label { font-size:13px; font-weight:600; }
    .comment-dropdown select { width:100%; margin:6px 0; padding:6px; border-radius:6px; border:1px solid #ccc; }
    .comment-dropdown .badge-container { margin-top:8px; display:flex; flex-wrap:wrap; gap:6px; }
    .comment-dropdown .badge { background:#f5f5f5; color:#333; padding:6px 12px; border-radius:16px; border:1px solid #ccc; cursor:pointer; font-size:13px; }
    .comment-dropdown .badge:hover { background:#e0e0e0; }
    .comment-dropdown button { margin-top:10px; padding:6px 12px; background:var(--primary); color:white; border:none; border-radius:6px; cursor:pointer; }
    .badge.active {background-color: #007bff;color: white;}

    /* Left align content for TextBrut, Notice, and Comment boxes */
    #textBrut,
    #notice,
    #commentBox {
      text-align: left;
      white-space: pre-wrap; /* keeps line breaks from your data */
      font-size: 14px;
      line-height: 1.4;
      display: block;
    }


  </style>
</head>
<body>

  <div id="header-container">Header Area</div>

  <main>
    <div class="content-area">
      <div class="left-panel image-panel" id="left2">
        <div class="toolbar">
          <button title="Retourner"><i class="fa-solid fa-rotate-left"></i></button>
          <button title="Précédent"><i class="fa-solid fa-arrow-left"></i></button>
          <button title="Suivant"><i class="fa-solid fa-arrow-right"></i></button>
          <button title="Favori"><i class="fa-solid fa-star"></i></button>
           <button title="Commenter (Comment)"><i class="fa-solid fa-comment-dots"></i></button>
          <button title="Enregistrer"><i class="fa-solid fa-floppy-disk"></i></button>
          <span class="record">Record ID: <strong>335792</strong> | 27F05 | .jpg</span>
        </div>
        <!-- Form -->
        <form class="form-ui">
          <div class="form-row two-cols">
            <div>
              <label>Traitement</label>
              <select>
                <option>SAISIE</option>
                <option>VALIDATION</option>
              </select>
            </div>
            <div>
              <label>Qcode</label>
              <input type="text" value="236682">
            </div>
          </div>
          <div class="form-row two-cols">
            <div>
              <label>Ano Msg</label>
              <input type="text" placeholder="Ano Msg">
            </div>
            <div>
              <label>Ano Code</label>
              <input type="text" value="-">
            </div>
          </div>
          <div class="form-row">
            <label>TextBrut</label>
            <textarea id="textBrut" rows="9" contenteditable="true" class="editable-content">
SEP :
DIM : 19 cm
COT : 236682
CB : 0066248871
NUL :
COL : COLLECTION COLETTE
AUT : Hélène PICARD
TIT : SABBAT Romain
AUT : Préface de COLETTE
EDI : PARIS, J. FERENCZI ET FILS, ÉDITEURS
            </textarea>
          </div>
          <div class="form-row">
            <label>Notice</label>
            <textarea id="notice" rows="9" contenteditable="true" class="editable-content">
LONGUnam_22DEPAR1 450
001 : 27F05-1
008 ##$aAax3
100 ##$a1923
101 0#$afre
102 ##$aFR
105 ##$ay$bc$yc$dba$e0$ffre
105 ##$ay$bzc$0$d$0$e0$fa$gv
            </textarea>
          </div>
          <!-- ✅ New Comment Field -->
          <div class="form-row">
            <label>Comment</label>
            <textarea id="commentBox" rows="5" placeholder="Comments will appear here..."></textarea>
          </div>
          <!-- <div class="form-row">
            <button>Save</button>
          </div> -->
        </form>
      </div>

      <div class="divider" id="divider2"></div>

      <!-- Right Panel (Image Viewer) -->
      <div class="right-panel">
        <div id="your_div_image_container"></div>

        <!-- Thumbnail Pagination -->
        <div class="thumbnail-gallery-wrapper">
          <button class="thumb-nav thumb-prev">&#10094;</button>
          <div class="thumbnail-gallery" id="thumbnailGallery"></div>
          <button class="thumb-nav thumb-next">&#10095;</button>
        </div>
      </div>
    </div>
  </main>

  <div id="footer-container">Footer Area</div>


<!-- ✅ Comment Popup Modal -->
<div id="commentPopup" class="popup-overlay">
  <div class="popup-content">
    <span class="popup-close">&times;</span>
    <h3><i class="fa-solid fa-comment-dots"></i> Comment Box</h3>
    <textarea id="popupComment" rows="6" placeholder="Write your comment here..."></textarea>
    <div class="popup-actions">
      <button id="saveCommentBtn">Save</button>
      <button id="cancelCommentBtn">Cancel</button>
    </div>
  </div>
</div>

   <script src="../Script/script.js"></script>
   <script src="../Script/comment.js"></script>
   <script src="../Script/FormDivider.js"></script>
   <script src="../Script/FormImageViewer.js"></script>

   <script>
    // Popup logic
document.addEventListener("DOMContentLoaded", () => {
  const popup = document.getElementById("commentPopup");
  const popupClose = popup.querySelector(".popup-close");
  const saveBtn = document.getElementById("saveCommentBtn");
  const cancelBtn = document.getElementById("cancelCommentBtn");
  const commentIcon = document.querySelector('.fa-comment-dots');
  const popupComment = document.getElementById("popupComment");
  const commentBox = document.getElementById("commentBox");

  // Open popup
  commentIcon.addEventListener("click", () => {
    popup.classList.add("active");
    popupComment.value = commentBox.value || ""; // preload current comment
  });

  // Close popup
  function closePopup() {
    popup.classList.remove("active");
  }

  popupClose.addEventListener("click", closePopup);
  cancelBtn.addEventListener("click", closePopup);

  // Save comment to main textarea
  saveBtn.addEventListener("click", () => {
    commentBox.value = popupComment.value.trim();
    closePopup();
  });

  // Close when clicking outside popup
  popup.addEventListener("click", (e) => {
    if (e.target === popup) closePopup();
  });
});

</script>
<script src="../Script/header.js"></script>
<script src="../Script/Footer.js"></script>

</body>
</html>
